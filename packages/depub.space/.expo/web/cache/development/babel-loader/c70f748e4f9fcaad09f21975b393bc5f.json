{"ast":null,"code":"import { canUseDOM } from 'fbjs/lib/ExecutionEnvironment';\nimport createCSSStyleSheet from \"./createCSSStyleSheet\";\nimport createCompileableStyle from \"./createCompileableStyle\";\nimport createOrderedCSSStyleSheet from \"./createOrderedCSSStyleSheet\";\nimport flattenArray from \"../../modules/flattenArray\";\nimport flattenStyle from \"./flattenStyle\";\nimport I18nManager from \"../I18nManager\";\nimport i18nStyle from \"./i18nStyle\";\nimport { atomic, classic, inline, stringifyValueWithProperty } from \"./compile\";\nimport initialRules from \"./initialRules\";\nimport modality from \"./modality\";\nimport { STYLE_ELEMENT_ID, STYLE_GROUPS } from \"./constants\";\nexport default function createStyleResolver() {\n  var inserted, sheet, cache;\n  var resolved = {\n    css: {},\n    ltr: {},\n    rtl: {},\n    rtlNoSwap: {}\n  };\n\n  var init = function init() {\n    inserted = {\n      css: {},\n      ltr: {},\n      rtl: {},\n      rtlNoSwap: {}\n    };\n    sheet = createOrderedCSSStyleSheet(createCSSStyleSheet(STYLE_ELEMENT_ID));\n    cache = {};\n    modality(function (rule) {\n      return sheet.insert(rule, STYLE_GROUPS.modality);\n    });\n    initialRules.forEach(function (rule) {\n      sheet.insert(rule, STYLE_GROUPS.reset);\n    });\n  };\n\n  init();\n\n  function addToCache(className, prop, value) {\n    if (!cache[prop]) {\n      cache[prop] = {};\n    }\n\n    cache[prop][value] = className;\n  }\n\n  function getClassName(prop, value) {\n    var val = stringifyValueWithProperty(value, prop);\n    return cache[prop] && cache[prop].hasOwnProperty(val) && cache[prop][val];\n  }\n\n  function _injectRegisteredStyle(id) {\n    var _I18nManager$getConst = I18nManager.getConstants(),\n        doLeftAndRightSwapInRTL = _I18nManager$getConst.doLeftAndRightSwapInRTL,\n        isRTL = _I18nManager$getConst.isRTL;\n\n    var dir = isRTL ? doLeftAndRightSwapInRTL ? 'rtl' : 'rtlNoSwap' : 'ltr';\n\n    if (!inserted[dir][id]) {\n      var style = createCompileableStyle(i18nStyle(flattenStyle(id)));\n      var results = atomic(style);\n      Object.keys(results).forEach(function (key) {\n        var _results$key = results[key],\n            identifier = _results$key.identifier,\n            property = _results$key.property,\n            rules = _results$key.rules,\n            value = _results$key.value;\n        addToCache(identifier, property, value);\n        rules.forEach(function (rule) {\n          var group = STYLE_GROUPS.custom[property] || STYLE_GROUPS.atomic;\n          sheet.insert(rule, group);\n        });\n      });\n      inserted[dir][id] = true;\n    }\n  }\n\n  function resolve(style, classList) {\n    var nextClassList = [];\n    var props = {};\n\n    if (!style && !classList) {\n      return props;\n    }\n\n    if (Array.isArray(classList)) {\n      flattenArray(classList).forEach(function (identifier) {\n        if (identifier) {\n          if (inserted.css[identifier] == null && resolved.css[identifier] != null) {\n            var item = resolved.css[identifier];\n            item.rules.forEach(function (rule) {\n              sheet.insert(rule, item.group);\n            });\n            inserted.css[identifier] = true;\n          }\n\n          nextClassList.push(identifier);\n        }\n      });\n    }\n\n    if (typeof style === 'number') {\n      _injectRegisteredStyle(style);\n\n      var key = createCacheKey(style);\n      props = _resolveStyle(style, key);\n    } else if (!Array.isArray(style)) {\n      props = _resolveStyle(style);\n    } else {\n      var flatArray = flattenArray(style);\n      var isArrayOfNumbers = true;\n      var cacheKey = '';\n\n      for (var i = 0; i < flatArray.length; i++) {\n        var id = flatArray[i];\n\n        if (typeof id !== 'number') {\n          isArrayOfNumbers = false;\n        } else {\n          if (isArrayOfNumbers) {\n            cacheKey += id + '-';\n          }\n\n          _injectRegisteredStyle(id);\n        }\n      }\n\n      var _key = isArrayOfNumbers ? createCacheKey(cacheKey) : null;\n\n      props = _resolveStyle(flatArray, _key);\n    }\n\n    nextClassList.push.apply(nextClassList, props.classList);\n    var finalProps = {\n      className: classListToString(nextClassList),\n      classList: nextClassList\n    };\n\n    if (props.style) {\n      finalProps.style = props.style;\n    }\n\n    return finalProps;\n  }\n\n  function _resolveStyle(style, key) {\n    var _I18nManager$getConst2 = I18nManager.getConstants(),\n        doLeftAndRightSwapInRTL = _I18nManager$getConst2.doLeftAndRightSwapInRTL,\n        isRTL = _I18nManager$getConst2.isRTL;\n\n    var dir = isRTL ? doLeftAndRightSwapInRTL ? 'rtl' : 'rtlNoSwap' : 'ltr';\n\n    if (key != null && resolved[dir][key] != null) {\n      return resolved[dir][key];\n    }\n\n    var flatStyle = flattenStyle(style);\n    var localizedStyle = createCompileableStyle(i18nStyle(flatStyle));\n    var props = Object.keys(localizedStyle).sort().reduce(function (props, styleProp) {\n      var value = localizedStyle[styleProp];\n\n      if (value != null) {\n        var className = getClassName(styleProp, value);\n\n        if (className) {\n          props.classList.push(className);\n        } else {\n          if (styleProp === 'animationKeyframes' || styleProp === 'placeholderTextColor' || styleProp === 'pointerEvents' || styleProp === 'scrollbarWidth') {\n            var _atomic;\n\n            var a = atomic((_atomic = {}, _atomic[styleProp] = value, _atomic));\n            Object.keys(a).forEach(function (key) {\n              var _a$key = a[key],\n                  identifier = _a$key.identifier,\n                  rules = _a$key.rules;\n              props.classList.push(identifier);\n              rules.forEach(function (rule) {\n                sheet.insert(rule, STYLE_GROUPS.atomic);\n              });\n            });\n          } else {\n            if (!props.style) {\n              props.style = {};\n            }\n\n            props.style[styleProp] = value;\n          }\n        }\n      }\n\n      return props;\n    }, {\n      classList: []\n    });\n\n    if (props.style) {\n      props.style = inline(props.style);\n    }\n\n    if (key != null) {\n      resolved[dir][key] = props;\n    }\n\n    return props;\n  }\n\n  return {\n    getStyleSheet: function getStyleSheet() {\n      var textContent = sheet.getTextContent();\n\n      if (!canUseDOM) {\n        init();\n      }\n\n      return {\n        id: STYLE_ELEMENT_ID,\n        textContent: textContent\n      };\n    },\n    createCSS: function createCSS(rules, group) {\n      var result = {};\n      Object.keys(rules).forEach(function (name) {\n        var style = rules[name];\n        var compiled = classic(style, name);\n        Object.keys(compiled).forEach(function (key) {\n          var _compiled$key = compiled[key],\n              identifier = _compiled$key.identifier,\n              rules = _compiled$key.rules;\n          resolved.css[identifier] = {\n            group: group || STYLE_GROUPS.classic,\n            rules: rules\n          };\n          result[name] = identifier;\n        });\n      });\n      return result;\n    },\n    resolve: resolve,\n\n    get sheet() {\n      return sheet;\n    }\n\n  };\n}\n\nvar createCacheKey = function createCacheKey(id) {\n  var prefix = 'rn';\n  return prefix + \"-\" + id;\n};\n\nvar classListToString = function classListToString(list) {\n  return list.join(' ').trim();\n};\n\n;\n\nvar _a, _b;\n\nif (typeof self !== 'undefined' && '$RefreshHelpers$' in self) {\n  var currentExports = module.__proto__.exports;\n  var prevExports = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevExports) !== null && _b !== void 0 ? _b : null;\n  self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n\n  if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n    module.hot.dispose(function (data) {\n      data.prevExports = currentExports;\n    });\n    module.hot.accept();\n\n    if (prevExports !== null) {\n      if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevExports, currentExports)) {\n        module.hot.invalidate();\n      } else {\n        self.$RefreshHelpers$.scheduleUpdate();\n      }\n    }\n  } else {\n    var isNoLongerABoundary = prevExports !== null;\n\n    if (isNoLongerABoundary) {\n      module.hot.invalidate();\n    }\n  }\n}","map":{"version":3,"sources":["/media/disk1/projects/depub.space/node_modules/react-native-web/dist/exports/StyleSheet/createStyleResolver.js"],"names":["resolved","css","ltr","rtl","rtlNoSwap","init","inserted","sheet","createOrderedCSSStyleSheet","createCSSStyleSheet","cache","modality","STYLE_GROUPS","initialRules","val","stringifyValueWithProperty","_I18nManager$getConst","I18nManager","doLeftAndRightSwapInRTL","isRTL","dir","style","createCompileableStyle","i18nStyle","flattenStyle","results","atomic","Object","_results$key","identifier","property","rules","value","addToCache","group","nextClassList","props","Array","flattenArray","item","_injectRegisteredStyle","key","createCacheKey","_resolveStyle","flatArray","isArrayOfNumbers","cacheKey","i","id","_key","finalProps","className","classListToString","classList","_I18nManager$getConst2","flatStyle","localizedStyle","getClassName","styleProp","a","_atomic","_a$key","inline","getStyleSheet","textContent","createCSS","result","compiled","classic","_compiled$key","resolve","prefix","list"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Nicolas Gallagher.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n */\n\n/**\n * WARNING: changes to this file in particular can cause significant changes to\n * the results of render performance benchmarks.\n */\nimport { canUseDOM } from 'fbjs/lib/ExecutionEnvironment';\nimport createCSSStyleSheet from './createCSSStyleSheet';\nimport createCompileableStyle from './createCompileableStyle';\nimport createOrderedCSSStyleSheet from './createOrderedCSSStyleSheet';\nimport flattenArray from '../../modules/flattenArray';\nimport flattenStyle from './flattenStyle';\nimport I18nManager from '../I18nManager';\nimport i18nStyle from './i18nStyle';\nimport { atomic, classic, inline, stringifyValueWithProperty } from './compile';\nimport initialRules from './initialRules';\nimport modality from './modality';\nimport { STYLE_ELEMENT_ID, STYLE_GROUPS } from './constants';\nexport default function createStyleResolver() {\n  var inserted, sheet, cache;\n  var resolved = {\n    css: {},\n    ltr: {},\n    rtl: {},\n    rtlNoSwap: {}\n  };\n\n  var init = function init() {\n    inserted = {\n      css: {},\n      ltr: {},\n      rtl: {},\n      rtlNoSwap: {}\n    };\n    sheet = createOrderedCSSStyleSheet(createCSSStyleSheet(STYLE_ELEMENT_ID));\n    cache = {};\n    modality(function (rule) {\n      return sheet.insert(rule, STYLE_GROUPS.modality);\n    });\n    initialRules.forEach(function (rule) {\n      sheet.insert(rule, STYLE_GROUPS.reset);\n    });\n  };\n\n  init();\n\n  function addToCache(className, prop, value) {\n    if (!cache[prop]) {\n      cache[prop] = {};\n    }\n\n    cache[prop][value] = className;\n  }\n\n  function getClassName(prop, value) {\n    var val = stringifyValueWithProperty(value, prop);\n    return cache[prop] && cache[prop].hasOwnProperty(val) && cache[prop][val];\n  }\n\n  function _injectRegisteredStyle(id) {\n    var _I18nManager$getConst = I18nManager.getConstants(),\n        doLeftAndRightSwapInRTL = _I18nManager$getConst.doLeftAndRightSwapInRTL,\n        isRTL = _I18nManager$getConst.isRTL;\n\n    var dir = isRTL ? doLeftAndRightSwapInRTL ? 'rtl' : 'rtlNoSwap' : 'ltr';\n\n    if (!inserted[dir][id]) {\n      var style = createCompileableStyle(i18nStyle(flattenStyle(id)));\n      var results = atomic(style);\n      Object.keys(results).forEach(function (key) {\n        var _results$key = results[key],\n            identifier = _results$key.identifier,\n            property = _results$key.property,\n            rules = _results$key.rules,\n            value = _results$key.value;\n        addToCache(identifier, property, value);\n        rules.forEach(function (rule) {\n          var group = STYLE_GROUPS.custom[property] || STYLE_GROUPS.atomic;\n          sheet.insert(rule, group);\n        });\n      });\n      inserted[dir][id] = true;\n    }\n  }\n  /**\n   * Resolves a React Native style object to DOM attributes\n   */\n\n\n  function resolve(style, classList) {\n    var nextClassList = [];\n    var props = {};\n\n    if (!style && !classList) {\n      return props;\n    }\n\n    if (Array.isArray(classList)) {\n      flattenArray(classList).forEach(function (identifier) {\n        if (identifier) {\n          if (inserted.css[identifier] == null && resolved.css[identifier] != null) {\n            var item = resolved.css[identifier];\n            item.rules.forEach(function (rule) {\n              sheet.insert(rule, item.group);\n            });\n            inserted.css[identifier] = true;\n          }\n\n          nextClassList.push(identifier);\n        }\n      });\n    }\n\n    if (typeof style === 'number') {\n      // fast and cachable\n      _injectRegisteredStyle(style);\n\n      var key = createCacheKey(style);\n      props = _resolveStyle(style, key);\n    } else if (!Array.isArray(style)) {\n      // resolve a plain RN style object\n      props = _resolveStyle(style);\n    } else {\n      // flatten the style array\n      // cache resolved props when all styles are registered\n      // otherwise fallback to resolving\n      var flatArray = flattenArray(style);\n      var isArrayOfNumbers = true;\n      var cacheKey = '';\n\n      for (var i = 0; i < flatArray.length; i++) {\n        var id = flatArray[i];\n\n        if (typeof id !== 'number') {\n          isArrayOfNumbers = false;\n        } else {\n          if (isArrayOfNumbers) {\n            cacheKey += id + '-';\n          }\n\n          _injectRegisteredStyle(id);\n        }\n      }\n\n      var _key = isArrayOfNumbers ? createCacheKey(cacheKey) : null;\n\n      props = _resolveStyle(flatArray, _key);\n    }\n\n    nextClassList.push.apply(nextClassList, props.classList);\n    var finalProps = {\n      className: classListToString(nextClassList),\n      classList: nextClassList\n    };\n\n    if (props.style) {\n      finalProps.style = props.style;\n    }\n\n    return finalProps;\n  }\n  /**\n   * Resolves a React Native style object\n   */\n\n\n  function _resolveStyle(style, key) {\n    var _I18nManager$getConst2 = I18nManager.getConstants(),\n        doLeftAndRightSwapInRTL = _I18nManager$getConst2.doLeftAndRightSwapInRTL,\n        isRTL = _I18nManager$getConst2.isRTL;\n\n    var dir = isRTL ? doLeftAndRightSwapInRTL ? 'rtl' : 'rtlNoSwap' : 'ltr'; // faster: memoized\n\n    if (key != null && resolved[dir][key] != null) {\n      return resolved[dir][key];\n    }\n\n    var flatStyle = flattenStyle(style);\n    var localizedStyle = createCompileableStyle(i18nStyle(flatStyle)); // slower: convert style object to props and cache\n\n    var props = Object.keys(localizedStyle).sort().reduce(function (props, styleProp) {\n      var value = localizedStyle[styleProp];\n\n      if (value != null) {\n        var className = getClassName(styleProp, value);\n\n        if (className) {\n          props.classList.push(className);\n        } else {\n          // Certain properties and values are not transformed by 'createReactDOMStyle' as they\n          // require more complex transforms into multiple CSS rules. Here we assume that StyleManager\n          // can bind these styles to a className, and prevent them becoming invalid inline-styles.\n          if (styleProp === 'animationKeyframes' || styleProp === 'placeholderTextColor' || styleProp === 'pointerEvents' || styleProp === 'scrollbarWidth') {\n            var _atomic;\n\n            var a = atomic((_atomic = {}, _atomic[styleProp] = value, _atomic));\n            Object.keys(a).forEach(function (key) {\n              var _a$key = a[key],\n                  identifier = _a$key.identifier,\n                  rules = _a$key.rules;\n              props.classList.push(identifier);\n              rules.forEach(function (rule) {\n                sheet.insert(rule, STYLE_GROUPS.atomic);\n              });\n            });\n          } else {\n            if (!props.style) {\n              props.style = {};\n            } // 4x slower render\n\n\n            props.style[styleProp] = value;\n          }\n        }\n      }\n\n      return props;\n    }, {\n      classList: []\n    });\n\n    if (props.style) {\n      props.style = inline(props.style);\n    }\n\n    if (key != null) {\n      resolved[dir][key] = props;\n    }\n\n    return props;\n  }\n\n  return {\n    getStyleSheet: function getStyleSheet() {\n      var textContent = sheet.getTextContent(); // Reset state on the server so critical css is always the result\n\n      if (!canUseDOM) {\n        init();\n      }\n\n      return {\n        id: STYLE_ELEMENT_ID,\n        textContent: textContent\n      };\n    },\n    createCSS: function createCSS(rules, group) {\n      var result = {};\n      Object.keys(rules).forEach(function (name) {\n        var style = rules[name];\n        var compiled = classic(style, name);\n        Object.keys(compiled).forEach(function (key) {\n          var _compiled$key = compiled[key],\n              identifier = _compiled$key.identifier,\n              rules = _compiled$key.rules;\n          resolved.css[identifier] = {\n            group: group || STYLE_GROUPS.classic,\n            rules: rules\n          };\n          result[name] = identifier;\n        });\n      });\n      return result;\n    },\n    resolve: resolve,\n\n    get sheet() {\n      return sheet;\n    }\n\n  };\n}\n/**\n * Misc helpers\n */\n\nvar createCacheKey = function createCacheKey(id) {\n  var prefix = 'rn';\n  return prefix + \"-\" + id;\n};\n\nvar classListToString = function classListToString(list) {\n  return list.join(' ').trim();\n};"]},"metadata":{},"sourceType":"module"}